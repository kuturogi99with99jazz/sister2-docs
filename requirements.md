# 📗 Sister 2 要件定義書

## 1. システム概要

Sister 2は、既存のプロジェクト進捗管理システムを、**Work（仕事）中心モデル**として再構築することを目的とします。  
管理の最小単位を「プロジェクト」ではなく「人が日々行うWork」とし、開発・運用・保守・定期作業・突発対応を一元的に扱います。

### 1.1 追加検討事項

- 想定ユーザー規模
  - 同時接続数: 10-100
  - 総ユーザー数: 30-300
  - 組織数: 1-10

---

## 2. 目的・背景

| 項目 | 内容 |
|------|------|
| 現状の課題 | 業務構造とデータ構造の乖離、運用/保守の可視化不足、工数入力負荷 |
| 解決方針 | Workを最小単位として定義し、操作ログから稼働を推定する |
| 目的 | 実態に即した業務管理と、将来的なAI活用に耐える基盤構築 |

- KPI目標値
  - MAU: 100以上
  - DAU: 20以上
  - アクティブ組織数: 5以上
  - Work完了リードタイム中央値: 3日以内
  - 可用性: 99.9%以上
  - 月額コスト: 50ドル以下

---

## 3. スコープ（対象/非対象）

- 対象: Work管理、Work対象（プロジェクト/システム/共通業務）管理、ナレッジ管理、通知、ファイル管理、分析、認証・認可
- 対象: 管理業務（マスタ管理、システム設定管理）
- 対象: チャット機能、社内ツール（定義駆動型）
- 非対象: 現行Sisterのソフトウェア開発報告書チェックツールは社内ツールに吸収するので対象外、現行AI分析も対象外

---

## 4. 機能要件

MVP範囲（必須/後回し）の機能優先度は本章の上から順とする。

### 4.1 Work管理（コア）

Workの一覧、登録、編集、削除を提供し、ステータス・期日・担当者・対象を追跡できること。  
一覧画面では、サマリー（Total/Completed/In Progress）とリストを表示し、対象・担当者・ステータス・タグ・日付で絞り込みできること。  
一覧では「Show Filters」「Create New Work」を主要アクションとして提供すること。  
リストはステータス、タイトル、計画/実績日付、担当者、対象、タグを表示すること。  
詳細画面ではWork本文、コメント数、推定稼働時間、履歴を確認できること。  
タグは複数付与でき、色付きラベルで表示されること。  
作成/更新/削除およびステータス変更の監査ログを記録すること。

登録/編集時は work_id, created_by, title, content, status, start_date_planned, end_date_planned を必須とし、start_date_actual, end_date_actual, tags は任意とする。  
Workは複数人担当を許容し、責任者（PIC）を明示できること。

#### 4.1.1 追加検討事項

- [Assumption] statusの値域: Not Started / In Progress / Completed / On Hold / Cancelled
- [Open Question] Work完了判定条件（ステータス/日付/レビュー）
- [Risk] 一括アップロード時のバリデーション/重複処理が未定義

---

### 4.2 Work分類（業務の性質・時間特性）

Workを以下の軸で分類し、検索・集計に利用できること。  
- 業務の性質（開発／運用／保守／障害対応 等）  
- 時間的特性（単発／定期／突発）

分類はマスタ管理とし、管理者のみが追加/編集できること。

#### 4.2.1 追加検討事項

- [Assumption] 分類は `work_type` / `work_time_type` の2軸で管理
- [Open Question] 分類の初期セットと廃止ルール

---

### 4.3 Work対象（ターゲット）管理

Workが紐づく「対象」を以下の種別として管理できること。  
- システム  
- プロジェクト  
- 共通業務（会社/部門/横断業務など）

Workは対象への紐付けが任意であり、複数対象への紐付けを許容すること。  
プロジェクトおよびシステムは、Workが紐づく「対象の一種」として扱うこと。

#### 4.3.1 追加検討事項

- [Open Question] 対象の粒度（システム/サブシステム/モジュール）
- [Open Question] 共通業務の表現方法（対象テーブル/タグ/階層）

---

### 4.4 操作ログと稼働時間（自動算出）

Workの開始・完了・更新などの操作ログを記録できること。  
工数は別途入力させるのではなく、操作ログをもとに自動的に算出できること。  
正確な時間入力を強制せず、担当者の業務負荷を増やさない運用を前提とすること。

#### 4.4.1 追加検討事項

- [Open Question] 稼働時間の算出ルール（開始/停止の定義、放置時間の扱い）
- [Open Question] 並行作業の扱い（重複除外/重み付け）
- [Risk] 自動算出と実態乖離時の補正フローが未定義

---

### 4.5 ナレッジ管理

記事の投稿とドラフト管理を提供し、タグ付けとAI要約を行えること。  
公開/下書きの状態を扱い、検索・整理に必要なメタ情報を保持できること。  
記事はタイトル、本文、カテゴリ、タグ、作成者、公開日時を管理できること。  
下書きは作成者のみ編集でき、公開後は権限に応じて編集/非公開にできること。  
記事にはWork/対象への関連付けを行えること。  
AI要約は本文を基に生成し、要約結果を人が編集できること。  
記事は全文検索でき、タグ/カテゴリ/作成者/期間で絞り込みできること。

#### 4.5.1 追加検討事項

- [Open Question] AI要約の生成タイミング（保存時/公開時/手動実行）
- [Open Question] 記事の閲覧権限（組織内公開/対象限定）
- [Risk] AI要約の品質評価と手動修正フローが未定義

---

### 4.6 通知機能

Work完了・期限アラートなどの通知を送信できること。  
通知チャネルはメール等を中心に運用できること。  
通知はイベント種別（作成/更新/期限/メンション/承認）を識別できること。  
通知の受信可否はユーザー単位で設定できること。  
通知には対象リソース（Work/対象/チャット/社内ツール）へのリンク情報を含めること。  
通知送信の失敗は再送または管理者向けにエスカレーションできること。

#### 4.6.1 追加検討事項

- [Open Question] 通知頻度の集約ルール（即時/日次/週次）
- [Open Question] ユーザー単位の通知設定の初期値

---

### 4.7 ファイル管理

ファイルのアップロード/ダウンロードを提供し、署名付きURLを発行できること。  
ファイルはWork/対象/チャット/社内ツール等の関連リソースに紐づけられること。

---

### 4.8 分析機能

進捗率と稼働時間を可視化できること。  
定期的に集計結果を更新できること。  
Work対象単位/担当者単位/期間単位で集計を確認できること。  
集計結果はダッシュボード上で表示し、CSVなどでエクスポートできること。  
集計に利用した算出条件（期間、対象範囲、除外条件）を記録できること。

#### 4.8.1 追加検討事項

- [Open Question] 進捗率の算出ロジック（Work完了比率/稼働比率）
- [Open Question] 稼働時間の計測方法（操作ログのみ/補正入力）

---

### 4.9 社内ツール

定期作業・雑務のシステム化と属人化解消を目的とし、定義駆動（フォーム/ワークフロー/集計）で運用できること。  
対象業務は申請、報告、チェックリスト、集計業務とし、管理者のみが定義を編集できること。  
定義は公開/下書きの状態管理を持ち、定義ベースの型・必須・範囲チェックによる入力検証を行うこと。  
承認フローは2段階の承認に対応し、申請/承認/差戻し通知を送信できること。  
RBACによりツール単位で閲覧/操作を制御し、定義変更・申請・承認の履歴を記録すること。  
保存期間は最大1年を想定する。

- [Open Question] 既存Excel移行方針: [Suggestion] 重要帳票から優先移行、テンプレート化で段階移行
- [Assumption] ステータス遷移: draft → submitted → approved / rejected → resubmitted → cancelled
- [Assumption] 承認確定条件: step1 と step2 の両方通過で approved 確定

#### 4.9.1 追加検討事項

- [Open Question] 承認者割当ルール（step1/step2のロール紐付け）
- [Open Question] resubmitted時の取り扱い（履歴保持/再承認条件）
- [Risk] 定義変更と既存申請データの整合ルールが未定義

---

### 4.10 チャット機能

Work単位の進捗共有と意思決定の記録を簡易化できること。  
対象スコープはWork単位を基本とし、必要に応じて対象（プロジェクト/システム）単位のスレッドも扱えること。  
削除は投稿者と管理者に限定し、閲覧/投稿はRBACに準拠すること。  
メッセージ種別はテキスト/ファイル/システム通知を扱い、スレッド＋時系列の構造を持つこと。  
新着/メンション/期限関連の通知を送信し、S3署名URLで安全に添付を扱えること。  
送信・編集・削除は監査ログに記録し、保存期間は最大1年を想定する。  
UX要件として既読/未読、検索、メンション、簡易リアクションを提供する。

#### 4.10.1 追加検討事項

- [Open Question] systemメッセージの生成主体と投稿制限（サーバのみ/管理者のみ）
- [Open Question] chat_members.role の値域（owner/moderator/member など）
- [Open Question] 既読/未読の表示単位（スレッド/メッセージ）
- [Risk] 保存期間1年の根拠（法務/監査要件）の確認が必要

---

### 4.11 管理業務

管理者がシステム運用に必要なマスタと設定を管理できること。  
管理業務の操作は監査ログに記録し、編集権限は管理者ロールに限定すること。  
設定変更は履歴を保持し、差分表示ができること。

#### 4.11.1 マスタ管理機能

以下のマスタを必須とすること：ユーザー、会社、拠点、部門、ロール、リソース、パーミッション、タグ、カテゴリ、Work分類、Work対象。  
マスタは一覧/検索/登録/編集/削除に対応すること。  
参照先が存在するマスタは削除ではなく無効化（アーカイブ）を優先できること。  
マスタ変更時に影響範囲（関連Work/記事）を表示できること。  
CSV等による一括登録/更新に対応できること。

#### 4.11.2 追加検討事項

- [Open Question] Work分類・対象マスタの管理権限（全社/組織単位）
- [Risk] マスタ変更によるWork分類の履歴保持方針が未定義
