# 📄 Sister 2 PoC計画書（ドラフト）

## 0. 基本情報

| 項目 | 内容 |
|---|---|
| ドキュメント種別 | PoC計画書 |
| 対象フェーズ | 要件定義 / アーキテクチャ設計 |
| 位置付け | 実装前の検証計画 |
| 更新方針 | 要件確定に合わせて随時更新 |

---

## 1. 目的

Sister 2 の主要アーキテクチャ（SvelteKit + Vercel / FastAPI on Lambda / Neon / S3 / Cognito）における、  
基本フローの成立性・運用性・コスト感を PoC で検証する。

- [Assumption] 本 PoC は「設計の妥当性確認」を主目的とし、機能網羅は目的外とする

---

## 2. PoCの検証テーマ

| テーマ | 内容 | 成功基準（例） |
|---|---|---|
| アーキテクチャ成立性 | Vercel → API Gateway → Lambda → Neon / S3 の一連フロー | 基本CRUDが一通り成立 |
| 認証・認可 | Cognito連携のログイン/トークン連携 | 認証済みAPIのみアクセス可 |
| ファイル管理 | S3署名付きURLの発行/利用 | Upload/Downloadが安定動作 |
| 通知 | SES/SNSの通知送信 | トリガー通知が到達 |
| 運用性 | 監視・ログ・デプロイ | 追跡可能なログが残る |
| UI利用シーン適合 | iPadを主軸にしたUI検証（操作性/画面密度/携帯性） | iPadで主要導線がストレスなく成立 |
| 長時間処理の成立性 | Fargateを用いた非同期処理の起動/完了通知 | Lambdaでは難しい処理が分離実行できる |
| MCP理解/適用 | MCPの概念理解と自社向け活用余地の把握 | MCPサーバ設計の当たりが掴める |

- [Suggestion] AI要約連携は PoC の後半または任意検証に留める
- [Assumption] UI検証は「iPad > Desktop > Smartphone」の優先度で設計し、スマホは検索中心の検証に留める
- [Suggestion] PoC計画/仕様の更新はPRレビューを必須とする

---

## 3. PoC対象スコープ

### 3.1 対象機能（最小）

- プロジェクト管理（最小CRUD）
- タスク管理（最小CRUD）
- 認証（Cognito）
- ファイルアップロード（S3署名URL）
- 通知（SES/SNSの単一イベント通知）
- iPadを主軸としたUI検証（入力/閲覧の主要導線）
- Fargateを用いた非同期バッチの最小検証
- MCPのキャッチアップと設計メモ作成

### 3.2 非対象（本PoCでは扱わない）

- チャット機能
- 社内ツール機能
- 分析機能（集計/ダッシュボード）
- 既存データ移行
- 本番運用レベルのRBAC/監査ログ

- [Assumption] PoCではUI/UXは簡易版とし、主要導線のみ検証する

---

## 4. 期待成果物

| 成果物 | 内容 |
|---|---|
| PoC実行レポート | 目的・結果・検証ログ・課題 |
| 構成図 | 実運用を想定した構成メモ |
| API最小仕様 | PoCで使用したエンドポイント一覧 |
| 画面モック | 主要画面の簡易UI（ワイヤーフレームレベル） |
| MCP整理メモ | 用語・利用方針・自社MCPサーバの方向性案 |
| 非同期処理メモ | Fargate利用の前提/制約/実運用イメージ |

- [Suggestion] 失敗/詰まりポイントも必ず記録し、次フェーズの要件に反映する

---

## 5. 成功基準（ドラフト）

- [Suggestion] 主要フロー（ログイン → プロジェクト/タスクCRUD → ファイル操作）がデモ可能
- [Suggestion] API応答が安定し、エラーの原因追跡が可能なログが残る
- [Suggestion] コスト見積りの初期レンジ（$20〜50/月）が現実的か評価できる

---

## 6. 作業分解（案）

| フェーズ | 期間 | 作業 |
|---|---|---|
| 1. 設計整理 | 1〜2週 | PoC要件・範囲確定、API最小仕様作成 |
| 2. 構成準備 | 1〜2週 | Vercel/Lambda/Neon/S3/Cognito 接続確認 |
| 3. 検証実装 | 2〜3週 | 最小CRUDとファイル操作の動作確認 |
| 4. 検証/整理 | 1〜2週 | 監視・通知・コスト感の整理 |
| 5. レポート作成 | 1週 | 結果と課題のまとめ |

---

### 6.1 フェーズ成果物チェックリスト

| フェーズ | 成果物（チェック項目） |
|---|---|
| 1. 設計整理 | PoC範囲・優先順位の確定 / API最小仕様のドラフト / 主要ユースケースの確定 |
| 2. 構成準備 | Vercel/Lambda/Neon/S3/Cognitoの接続確認ログ / 初期デプロイ手順メモ |
| 3. 検証実装 | CRUD一通りの動作確認 / S3署名URLの検証 / 最低限のUI導線確認 |
| 4. 検証/整理 | 監視・ログの可視性確認 / コスト感の一次試算 / リスク課題の整理 |
| 5. レポート作成 | PoC実行レポート / 次フェーズの判断材料まとめ |

### 6.2 詰まりやすい工程（事前マーク）

- [Risk] Cognito連携（権限モデルやトークン運用の設計詰め）
- [Risk] Neonの接続方式（Lambda同時実行と接続上限の整合）
- [Risk] Vercel↔API Gateway連携のCORS/認証ヘッダ周り
- [Risk] S3署名URLの権限/期限設計
- [Risk] GitHub ActionsでのLambda自動デプロイ設定（権限/パッケージング）

---

### 6.3 CI/CD方針（PoC）

- [Assumption] リポジトリはGitHubを利用する
- [Assumption] PoC段階でも「自動デプロイまで」を必須とする

#### フロント（SvelteKit on Vercel）

- VercelのGitHub連携でPRプレビューとmainマージ後の自動デプロイを有効化

#### バックエンド（FastAPI on Lambda）

- GitHub Actionsでテスト/ビルド/デプロイを自動化（PoC向けの最小構成）
- デプロイ先はステージを1つに絞り、運用負荷を抑える

---

## 7. リスクと対策（ドラフト）

- [Risk] Cognitoの導入難易度が高く、PoC期間内で認証設計が固まらない可能性
  - [Suggestion] PoCは最小のユーザー種別で開始し、RBACは後工程に分離
  - [Assumption] PoCで行う範囲は「単一ロールのログイン/認証フロー成立」に限定する
  - [Assumption] PoCでは複数ロール/権限分岐、ユーザー招待・権限変更フローは扱わない
- [Risk] Neonの接続方式（コネクション管理）がLambda特性と合わない可能性
  - [Suggestion] コネクションプール方針は PoC の検証項目として明示
  - [Assumption] 同時実行を段階的に増やし、接続数の伸びとエラー発生条件を記録する
- [Risk] 署名URLの期限/権限設計が未定義
  - [Suggestion] 期間・権限を要件として決める前提で動作検証のみ実施

---

## 8. 前提・制約

- [Assumption] 本PoCは仕様確定前のため、要件変更を許容する
- [Assumption] 本PoCの成果は実装方針決定の判断材料に限定する
- [Assumption] 追加技術の採用は行わず、既定アーキテクチャ内で検証する

---

## 9. 未確定事項

- [Assumption] PoCの意思決定者はプロジェクトリーダー
- [Open Question] PoCの成果物レビュー形式（社内レビュー / ドキュメントのみ）
- [Open Question] どの業務シナリオをPoCのユースケースに採用するか
- [Open Question] PoCにおけるAI要約の扱い（実施/非実施）
